<!--pages/plan-detail/plan-detail.wxml-->
<view class="page-container">
  <!-- 顶部导航 -->
  <view class="top-nav">
    <view class="nav-left" bindtap="onBack">
      <image class="nav-icon" src="/images/icons/back.png" mode="aspectFit"></image>
    </view>
    <text class="nav-title">行程详情</text>
    <view class="nav-right" bindtap="onShare">
      <image class="nav-icon" src="/images/icons/share.png" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 分天切换 -->
  <scroll-view class="day-tabs" scroll-x>
    <view class="day-tabs-wrapper">
      <view 
        class="day-tab {{currentDay === index ? 'day-tab-active' : ''}}"
        wx:for="{{schedule}}"
        wx:key="day"
        bindtap="onDayChange"
        data-index="{{index}}"
      >
        <text>第{{item.day}}天</text>
      </view>
    </view>
  </scroll-view>

  <!-- 行程内容 -->
  <scroll-view class="content-scroll" scroll-y>
    <view class="schedule-container">
      <!-- 日期标题 -->
      <view class="date-header">
        <text class="date-text">第{{schedule[currentDay].day}}天 {{schedule[currentDay].date}}</text>
      </view>

      <!-- 时间轴 -->
      <view class="timeline">
        <view 
          class="timeline-item"
          wx:for="{{schedule[currentDay].items}}"
          wx:key="index"
        >
          <!-- 时间轴节点 -->
          <view class="timeline-node">
            <view class="node-icon {{getNodeClass(item.type)}}">
              <image class="node-image" src="{{getNodeIcon(item.type)}}" mode="aspectFit"></image>
            </view>
            <view class="node-line" wx:if="{{index < schedule[currentDay].items.length - 1}}"></view>
          </view>

          <!-- 内容 -->
          <view class="timeline-content">
            <text class="item-name">{{item.name}}</text>
            <text class="item-time">{{item.time}}</text>
            <view class="item-tags">
              <view class="item-tag" wx:if="{{item.tips}}">{{item.tips}}</view>
              <view class="item-tag">预计{{item.duration}}</view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 底部占位 -->
    <view class="bottom-placeholder"></view>
  </scroll-view>

  <!-- 底部按钮 -->
  <view class="bottom-action">
    <button class="action-btn" bindtap="onAddActivity">
      <image class="btn-icon" src="/images/icons/add.png" mode="aspectFit"></image>
      <text>添加活动到行程</text>
    </button>
  </view>
</view>
