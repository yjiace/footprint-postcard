<!--pages/plan/plan.wxml-->
<custom-navbar title="行程规划" background="transparent"></custom-navbar>

<view class="page-container">
  <view class="header">
    <text class="page-title">行程规划</text>
  </view>

  <scroll-view class="content-scroll" scroll-y>
    <view class="form-container">
      <!-- 选择城市 -->
      <view class="form-item">
        <view class="form-label-row">
          <text class="form-label">选择城市</text>
          <view class="current-location-btn" bindtap="useCurrentLocation">
            <view class="icon icon-location location-icon"></view>
            <text class="location-text">使用当前位置</text>
          </view>
        </view>
        <picker mode="region" value="{{cityRegion}}" bindchange="onCityChange">
          <view class="picker-input">
            <text class="{{city ? 'picker-value' : 'picker-placeholder'}}">
              {{city || '例如:上海'}}
            </text>
          </view>
        </picker>
      </view>

      <!-- 选择日期 -->
      <view class="form-item">
        <text class="form-label">选择日期</text>
        <picker mode="date" value="{{date}}" start="{{todayDate}}" bindchange="onDateChange">
          <view class="picker-input">
            <text class="{{date ? 'picker-value' : 'picker-placeholder'}}">
              {{date || '请选择出行日期'}}
            </text>
          </view>
        </picker>
      </view>

      <!-- 天数设置 -->
      <view class="form-item">
        <text class="form-label">天数设置</text>
        <picker mode="selector" range="{{dayOptions}}" value="{{dayIndex}}" bindchange="onDayChange">
          <view class="picker-input">
            <text class="picker-value">{{dayOptions[dayIndex]}}</text>
          </view>
        </picker>
      </view>

      <!-- 景点类型偏好 -->
      <view class="form-item">
        <text class="form-label">景点类型偏好</text>
        <view class="type-tags">
          <view 
            class="type-tag {{item.selected ? 'type-tag-active' : ''}}" 
            wx:for="{{poiTypes}}" 
            wx:key="id"
            bindtap="onPoiTypeToggle"
            data-index="{{index}}"
          >
            <text>{{item.name}}</text>
          </view>
        </view>
      </view>

      <!-- 备注 -->
      <view class="form-item">
        <text class="form-label">备注</text>
        <textarea 
          class="textarea-input" 
          placeholder="可说明人数、关系或预算等信息" 
          placeholder-class="textarea-placeholder"
          value="{{notes}}"
          bindblur="onNotesChange"
          maxlength="200"
        ></textarea>
      </view>

      <!-- 生成按钮 -->
      <view class="generate-btn-container">
        <button class="generate-btn" bindtap="onGenerate">开始规划</button>
        <text class="bottom-tip">点击后将为您生成详细行程,按天展示景点并按时间排序。</text>
      </view>
    </view>

    <!-- 底部占位 -->
    <view class="bottom-placeholder"></view>
  </scroll-view>
</view>
